<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Discord Login</title>
</head>
<body>
  <h2>Discordでログイン</h2>

  <button id="loginBtn">ログイン</button>
  <p id="result"></p>

  <script>
    const clientId = "1470485317092900997";
    const redirectUri = "https://stkrdevtool.github.io/Stkrapp/index.html";

    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");

    // ✅ code がある時はリダイレクトしない
    if (code) {
      document.getElementById("result").innerText =
        "ログイン成功！\ncode = " + code;

      // ボタンを無効化
      document.getElementById("loginBtn").disabled = true;
    } else {
      // code がない時だけログインさせる
      document.getElementById("loginBtn").onclick = () => {
        const authUrl =
          "https://discord.com/oauth2/authorize" +
          "?client_id=" + clientId +
          "&response_type=code" +
          "&redirect_uri=" + encodeURIComponent(redirectUri) +
          "&scope=identify email";

        location.href = authUrl;
      };
    }
  </script>
</body>
</html>
